# Clang-Format configuration for Reasons Decision Tree Debugger
# Based on LLVM style with project-specific customizations

BasedOnStyle: LLVM

# Language and standard
Language: Cpp
Standard: C99

# Indentation
IndentWidth: 4
TabWidth: 4
UseTab: Never
ContinuationIndentWidth: 4
IndentCaseLabels: true
IndentGotoLabels: true
IndentPPDirectives: BeforeHash
IndentWrappedFunctionNames: false
IndentAccessModifiers: false
IndentRequires: false

# Line breaking
ColumnLimit: 100
BreakBeforeBraces: Attach
BreakBeforeBinaryOperators: None
BreakBeforeTernaryOperators: true
BreakConstructorInitializers: BeforeColon
BreakInheritanceList: BeforeColon
BreakStringLiterals: true
AlwaysBreakAfterDefinitionReturnType: None
AlwaysBreakAfterReturnType: None
AlwaysBreakBeforeMultilineStrings: false
AlwaysBreakTemplateDeclarations: MultiLine

# Alignment
AlignAfterOpenBracket: Align
AlignArrayOfStructures: Right
AlignConsecutiveAssignments: None
AlignConsecutiveBitFields: None
AlignConsecutiveDeclarations: None
AlignConsecutiveMacros: AcrossEmptyLinesAndComments
AlignEscapedNewlines: Right
AlignOperands: AlignAfterOperator
AlignTrailingComments: true
DerivePointerAlignment: false
PointerAlignment: Right

# Spacing
SpaceAfterCStyleCast: true
SpaceAfterLogicalNot: false
SpaceAfterTemplateKeyword: true
SpaceAroundPointerQualifiers: Default
SpaceBeforeAssignmentOperators: true
SpaceBeforeCaseColon: false
SpaceBeforeCpp11BracedList: false
SpaceBeforeCtorInitializerColon: true
SpaceBeforeInheritanceColon: true
SpaceBeforeParens: ControlStatements
SpaceBeforeRangeBasedForLoopColon: true
SpaceBeforeSquareBrackets: false
SpaceInEmptyBlock: false
SpaceInEmptyParentheses: false
SpacesBeforeTrailingComments: 2
SpacesInAngles: Never
SpacesInCStyleCastParentheses: false
SpacesInConditionalStatement: false
SpacesInContainerLiterals: true
SpacesInParentheses: false
SpacesInSquareBrackets: false

# Function parameters and arguments
AllowAllArgumentsOnNextLine: true
AllowAllParametersOfDeclarationOnNextLine: true
BinPackArguments: false
BinPackParameters: false
ExperimentalAutoDetectBinPacking: false

# Short functions and statements
AllowShortBlocksOnASingleLine: Never
AllowShortCaseLabelsOnASingleLine: false
AllowShortEnumsOnASingleLine: true
AllowShortFunctionsOnASingleLine: None
AllowShortIfStatementsOnASingleLine: Never
AllowShortLambdasOnASingleLine: All
AllowShortLoopsOnASingleLine: false

# Includes
IncludeBlocks: Regroup
SortIncludes: CaseSensitive
IncludeCategories:
  # System headers
  - Regex: '^<.*\.h>'
    Priority: 1
    SortPriority: 1
  # System C++ headers
  - Regex: '^<.*>'
    Priority: 2
    SortPriority: 2
  # Project headers - reasons public API
  - Regex: '^"reasons\.h"'
    Priority: 3
    SortPriority: 3
  # Project headers - reasons modules
  - Regex: '^"reasons/.*"'
    Priority: 4
    SortPriority: 4
  # Project headers - utils
  - Regex: '^"utils/.*"'
    Priority: 5
    SortPriority: 5
  # Local headers
  - Regex: '^".*"'
    Priority: 6
    SortPriority: 6

# Macros and preprocessor
IndentPPDirectives: BeforeHash
MacroBlockBegin: ''
MacroBlockEnd: ''

# Comments
ReflowComments: true
CommentPragmas: '^ IWYU pragma:'

# Penalties (fine-tuning line breaking decisions)
PenaltyBreakAssignment: 2
PenaltyBreakBeforeFirstCallParameter: 19
PenaltyBreakComment: 300
PenaltyBreakFirstLessLess: 120
PenaltyBreakString: 1000
PenaltyBreakTemplateDeclaration: 10
PenaltyExcessCharacter: 1000000
PenaltyReturnTypeOnItsOwnLine: 60
PenaltyIndentedWhitespace: 0

# Other formatting options
CompactNamespaces: false
ConstructorInitializerAllOnOneLineOrOnePerLine: false
ConstructorInitializerIndentWidth: 4
Cpp11BracedListStyle: true
DeriveLineEnding: false
DisableFormat: false
EmptyLineAfterAccessModifier: Never
EmptyLineBeforeAccessModifier: LogicalBlock
FixNamespaceComments: true
ForEachMacros:
  - foreach
  - Q_FOREACH
  - BOOST_FOREACH
  - HASH_FOREACH
  - VECTOR_FOREACH
IfMacros:
  - KJ_IF_MAYBE
InsertTrailingCommas: None
KeepEmptyLinesAtTheStartOfBlocks: true
LambdaBodyIndentation: Signature
MaxEmptyLinesToKeep: 1
NamespaceIndentation: None
PPIndentWidth: -1
QualifierAlignment: Leave
ReferenceAlignment: Pointer
RemoveBracesLLVM: false
SeparateDefinitionBlocks: Leave
ShortNamespaceLines: 1
SortUsingDeclarations: true
SpaceAfterTemplateKeyword: true
SpaceInEmptyBlock: false
UseCRLF: false

# Attributes
AttributeMacros:
  - __capability

# Statement macros for reasons-specific constructs
StatementMacros:
  - TRACE_ENTER
  - TRACE_EXIT
  - DEBUG_PRINT
  - LOG_ERROR
  - LOG_WARN
  - LOG_INFO
  - ASSERT
  - REASONS_ASSERT

# Type names for better formatting
TypenameMacros:
  - STACK_OF
  - LIST_OF
